<!DOCTYPE html>
<html>
	<head>

		<title>SATGPT</title>

		<!-- meta data -->
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<meta name="description" content="">
		<meta name="keywords" content="">
		<meta name="author" content="">

		<!-- Google JavaScript loader tool (for the Maps, Charts APIs) -->
		<script src="https://www.google.com/jsapi"></script>

		<!-- Google Web Fonts -->
		<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
		<!-- Font Awesome -->
		<script src="https://kit.fontawesome.com/0ff5ca6dc9.js" crossorigin="anonymous"></script>

		<!-- Favicon -->
		<link rel="shortcut icon" type="image/png" href="static/images/favicon.png"/>

		<!-- Third-party JavaScript -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

		<!-- FOR MAPBOX -->
		<script src='https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js'></script>
		<script type="text/javascript">
			mapboxgl.accessToken = '{{ MAPBOX_ACCESS_KEY | safe }}';
		</script>
		
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.0/js/bootstrap-datepicker.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/6.1.5/bootstrap-slider.min.js"></script>

		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.0/css/bootstrap-datepicker.min.css">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/6.1.5/css/bootstrap-slider.min.css">

		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>

		<!-- Load custom JavaScript and stylesheet(s) -->
		<link rel="stylesheet" type="text/css" href="static\main.css">
		<script src="static\script.js"></script>
		<script src="static\ee_api_js.js"></script>

		<link href="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css" rel="stylesheet">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

		<!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"> -->
		<!-- <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script> -->
<!-- 		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
 -->
	</head>
	<body>	
	    <section id="pagecontent">
			<div class="water">

				<!-- The element into which Google Maps is rendered. -->
				<div id="map" class="map"></div>
				<!-- The UI wrapper. -->
				<div class="ui">

					<!-- Button that opens the main control box after it has been collapsed -->
					<div class="settings-button">&#9776;</div>
					<script>
					$(document).ready(function(){
						$(".mapboxgl-ctrl-top-right").css({
								"left": "340px",
								"z-index" : "1"
							});
						$(".settings-button").click(function () {
							$(".settings-button").toggle();
							$(".panel").toggle();
							$(".mapboxgl-ctrl-top-right").css({
								"left": "340px",
								"top": "0px"
							});
						});
					});
					</script>
					<div class="population-health-soil-container" id="populationHealthSoilContainer">
						<div id="soilTexturePanel" class="soil-texture-panel">
							<p><b>Soil Texture</b></p>
							<div class="soil-texture-container">
								<div class="color-box" style="background-color: #d5c36b;"></div>
								<span>Cl</span>
							</div>
							<div class="soil-texture-container">
								<div class="color-box" style="background-color: #b96947;"></div>
								<span>SiCl</span>
							</div>
							<div class="soil-texture-container">
								<div class="color-box" style="background-color: #9d3706;"></div>
								<span>SaCl</span>
							</div>
							<div class="soil-texture-container">
								<div class="color-box" style="background-color: #ae868f;"></div>
								<span>ClLo</span>
							</div>
							<div class="soil-texture-container">
								<div class="color-box" style="background-color: #f86714;"></div>
								<span>SiClLo</span>
							</div>
							<div class="soil-texture-container">
								<div class="color-box" style="background-color: #46d143;"></div>
								<span>SaClLo</span>
							</div>
							<div class="soil-texture-container">
								<div class="color-box" style="background-color: #368f20;"></div>
								<span>Lo</span>
							</div>
							<div class="soil-texture-container">
								<div class="color-box" style="background-color: #3e5a14;"></div>
								<span>SiLo</span>
							</div>
							<div class="soil-texture-container">
								<div class="color-box" style="background-color: #ffd557;"></div>
								<span>SaLo</span>
							</div>
							<div class="soil-texture-container">
								<div class="color-box" style="background-color: #fff72e;"></div>
								<span>Si</span>
							</div>
							<div class="soil-texture-container">
								<div class="color-box" style="background-color: #ff5a9d;"></div>
								<span>LoSa</span>
							</div>
							<div class="soil-texture-container">
								<div class="color-box" style="background-color: #ff005b;"></div>
								<span>Sa</span>
							</div>
						</div>
						<div id="healthCareAccessContainer" class="healthcare-access-container">
							<p><b>Healthcare Accessibility (min)</b></p>
							&gt;1000
							<div id="healthCareAccessGradient"></div>
							0
						</div>
						<div id="populationDensityContainer" class="population-density-container">
							<p><b>Population Density</b></p>
							&gt;1000
							<div id="populationDensityGradient"></div>
							0
						</div>
					</div>
					<div class="chat-box">
						<div id="suggestionsBox" style="display: none;">
							<h5>Try any of these...</h5>
							<div class="chat-message" onclick="fillInput(this)">Tell me about the 2010 Bangkok floods</div>
							<div class="chat-message" onclick="fillInput(this)">How big was the flood in North India in 2020?</div>
							<div class="chat-message" onclick="fillInput(this)">How much area was impacted by the 2007 Jakarta floods?</div>
						</div>
						<div id="suggestionsBoxFloodHotspot" style="display: none;">
							<h5>Try any of these...</h5>
							<div class="chat-message" onclick="fillInput(this)">Tell me about the 2010 to 2020 Bangkok floods</div>
							<div class="chat-message" onclick="fillInput(this)">Provide information regarding floods occurring in North India between 2015 and 2021</div>
							<div class="chat-message" onclick="fillInput(this)">Inform me about the floods in Jakarta spanning from 2007 to 2020</div>
						</div>
				
						<div class="chat-msg">
							<input type="text" class="chat-input" placeholder="Type your prompt here" id="inputBox">
							<button class="" onclick="fetchResponse();" ><i class="fa fa-send"></i></button>
						</div>
						<p class="error">* Please Enter the Valid Prompt to Proceed</p> 
						<br>
						<p class="year-error">* Please specify Year From and Year To with a duration of 5 to 25 years</p> 
					</div>
					<div class="pt-3 result-box ">
						<div class="result-text-box"><h4 style="margin: 0px;">Result</h4><i id="result-toggle" class="fa fa-angle-down" aria-hidden="true"></i></div>
						<div class="containerResult" style="opacity: 1;" id="container-result">
							<div class="text" id="myTextarea">Your long text goes here...Your long text goes here...Your long text goes here...Your long text goes here...Your long text goes here...Your long text goes here...Your long text goes here...Your long text goes here...Your long text goes here...Your long text goes here...Your long text goes here...Your long text goes here...Your long text goes here...Your long text goes here...Your long text goes here...</div>
						<div class="icon-button" onclick="refreshMap();">
							<i class="fa fa-refresh" style="font-size:32px;color:white"></i>
						</div>
						
						</div>

					</div>
					<div class="lclu-color-range-container">
						<div id="lcluPanel" class="lclu-panel">
							<p><b>LCLU</b></p>
							<div class="lclu-container">
								<div class="color-box" style="background-color: #006400;"></div>
								<span>Tree cover</span>
							</div>
							<div class="lclu-container">
								<div class="color-box" style="background-color: #ffbb22;"></div>
								<span>Shrubland</span>
							</div>
							<div class="lclu-container">
								<div class="color-box" style="background-color: #ffff4c;"></div>
								<span>Grassland</span>
							</div>
							<div class="lclu-container">
								<div class="color-box" style="background-color: #f096ff;"></div>
								<span>Cropland</span>
							</div>
							<div class="lclu-container">
								<div class="color-box" style="background-color: #fa0000;"></div>
								<span>Built-up</span>
							</div>
							<div class="lclu-container">
								<div class="color-box" style="background-color: #b4b4b4;"></div>
								<span>Bare/sparse vegetation</span>
							</div>
							<div class="lclu-container">
								<div class="color-box" style="background-color: #f0f0f0;"></div>
								<span>Snow and ice</span>
							</div>
							<div class="lclu-container">
								<div class="color-box" style="background-color: #0064c8;"></div>
								<span>Permanent water bodies</span>
							</div>
							<div class="lclu-container">
								<div class="color-box" style="background-color: #0096a0;"></div>
								<span>Herbaceous wetland</span>
							</div>
							<div class="lclu-container">
								<div class="color-box" style="background-color: #00cf75;"></div>
								<span>Mangroves</span>
							</div>
							<div class="lclu-container">
								<div class="color-box" style="background-color: #fae6a0;"></div>
								<span>Moss and lichen</span>
							</div>
						</div>
						<div id="colorRangePanel" class="color-range-panel">
							<p><b>Inundation Hotpots (%)</b></p>
							<div class="color-range-container">
								<div class="color-box" style="background-color: #ffa9bb;"></div>
								<span>&lt;10%</span>
							</div>
							<div class="color-range-container">
								<div class="color-box" style="background-color: #ff9cac;"></div>
								<span>10-20%</span>
							</div>
							<div class="color-range-container">
								<div class="color-box" style="background-color: #ff8f9e;"></div>
								<span>20-30%</span>
							</div>
							<div class="color-range-container">
								<div class="color-box" style="background-color: #ff8190;"></div>
								<span>30-40%</span>
							</div>
							<div class="color-range-container">
								<div class="color-box" style="background-color: #ff7281;"></div>
								<span>40-50%</span>
							</div>
							<div class="color-range-container">
								<div class="color-box" style="background-color: #ff6171;"></div>
								<span>50-60%</span>
							</div>
							<div class="color-range-container">
								<div class="color-box" style="background-color: #ff4f61;"></div>
								<span>60-70%</span>
							</div>
							<div class="color-range-container">
								<div class="color-box" style="background-color: #ff3b50;"></div>
								<span>70-80%</span>
							</div>
							<div class="color-range-container">
								<div class="color-box" style="background-color: #ff084a;"></div>
								<span>&gt;80%</span>
							</div>
							<div class="color-range-container">
								<div class="color-box" style="background-color: #00008B;"></div>
								<span>Permanent Water</span>
							</div>
						</div>
					</div>
					<!-- The main control box. -->
					<div class="panel">
						<header>
							<div>
								<div class="collapse-button" id="collapseButton">&#187;</div>
								<script>
									$(document).ready(function(){
										$(".collapse-button").click(function () {
											$(".panel").toggle();
											$(".settings-button").toggle();
											$(".mapboxgl-ctrl-top-right").css({
												"left": "8px",
												"top": "45px"
											});
										});
									});
									let collapseBtn = document.getElementById("collapseButton");
									let soilTexture = document.querySelector(".population-health-soil-container");
									let chatBox = document.querySelector(".chat-box")
									let resultBox = document.querySelector(".result-box")

									collapseBtn.addEventListener("click",()=>{
										soilTexture.classList.add("close-population-health-soil");
										chatBox.classList.add("collapse-panel-chatbox");
										resultBox.classList.add("collapse-panel-resultbox");
									});

									let settingBtn = document.querySelector(".settings-button");

									settingBtn.addEventListener("click",()=>{
										soilTexture.classList.remove("close-population-health-soil")
										chatBox.classList.remove("collapse-panel-chatbox")
										resultBox.classList.remove("collapse-panel-resultbox")                       
									})
								</script>
							</div>
							<img src="static/images/Sat-GPT-Logos-01.png" style="width: 90%;">
						</header>
						<hr style="margin: 10px 0px 20px 0px;">
						<div class="search-country-list">
							<script type="text/javascript">
								$(document).ready(function () {
									$.getJSON("./static/countries.json", function (data) {
										water.instance.countries = data;
										// this will show the info it in firebug console
										for (const k in data) {
											$('#country-list').append($('<option>', {
												value: k,
												text: data[k][0]
											}));
										}
									});
								});
							</script>
							<div class="slect-c">
								<h2>Layer Control</h2>
							<div>
							<div class="slect-c">
							<div>
								<div class="slect-c">
								<div style="padding-left: 10px;">
									<input type="checkbox" value="hd" class="select-box" id="historicalDataCheckbox" checked onchange="setLayersTransparencyOptions();removePreviousLayers();"> 
									<span>Single Inundation Event</span>
								</div>
								<!-- <div style="padding-left: 10px;">
									<input type="checkbox" value="uc" class="select-box" id="unsupervisedClassificationCheckbox" onchange="removePreviousLayers();">
									<span>Unsupervised Classification</span>
								</div> -->
								<div style="padding-left: 10px;">
									<input type="checkbox" value="uc" class="select-box" id="floodHotspotCheckbox" onchange="setLayersTransparencyOptions();removePreviousLayers();">
									<span>Inundation Hotspot</span>
								</div>
							<div>
								<script>
									const historicalDataCheckbox = document.getElementById("historicalDataCheckbox");
									// const unsupervisedClassificationCheckbox = document.getElementById("unsupervisedClassificationCheckbox");
									const floodHotspotCheckbox = document.getElementById("floodHotspotCheckbox");
									const colorRangePanel = document.getElementById('colorRangePanel');

									function removeGrid(){
										try {
											
											if (water.instance.map.getLayer("water-layer")) {
												water.instance.map.removeLayer('water-layer');
											}
											if (water.instance.map.getSource("water")){
												water.instance.map.removeSource("water");
											}
											if (water.instance.map.getLayer("LineString")) {
												water.instance.map.removeLayer('LineString');
											}
											
										} catch (e) {
											console.log(e);
										}
									}

									historicalDataCheckbox.addEventListener("click", function () {
										removeGrid();

										if (historicalDataCheckbox.checked) {
											$('#yearControl').slider('disable');
											let modal = document.getElementById("promptModal");
											let modalBackdrop = document.querySelector(".modal-backdrop");
											// unsupervisedClassificationCheckbox.checked = false;
											floodHotspotCheckbox.checked = false;
											document.getElementById('suggestionsBox').hidden = false;
											document.getElementById('suggestionsBoxFloodHotspot').hidden = true;
											document.getElementById('colorRangePanel').style.display = 'none';
											modalBackdrop.style.display = "block";
											modal.style.display = "block";
										}
									});

									// unsupervisedClassificationCheckbox.addEventListener("click", function () {
									// 	removeGrid();

									// 	if (unsupervisedClassificationCheckbox.checked) {
									// 		let modal = document.getElementById("promptModal");
									// 		let modalBackdrop = document.querySelector(".modal-backdrop");
									// 		historicalDataCheckbox.checked = false;
									// 		floodHotspotCheckbox.checked = false;
									// 		modalBackdrop.style.display = "block";
									// 		modal.style.display = "block";
									// 	}
									// });

									floodHotspotCheckbox.addEventListener("click", function () {
										removeGrid();

										if (floodHotspotCheckbox.checked) {
											$('#yearControl').slider('enable');
											let modal = document.getElementById("promptModal");
											let modalBackdrop = document.querySelector(".modal-backdrop");
											// unsupervisedClassificationCheckbox.checked = false;
											historicalDataCheckbox.checked = false;
											document.getElementById('suggestionsBox').hidden = true;
											document.getElementById('suggestionsBoxFloodHotspot').hidden = false;
											document.getElementById('colorRangePanel').style.display = 'block';
											modalBackdrop.style.display = "block";
											modal.style.display = "block";
										}
									});
								</script>
						</div>
						<div id="yearControlledSlider">
							<p>Hotspot Duration</p>
							<div class="trp-range">
								<label>5 Years</label>
								<label>25 Years</label>
						</div>
						<input id="yearControl" class="" data-slider-id='yearControlSlider' type="text" data-slider-min="5" data-slider-max="25" data-slider-step="1" data-slider-value="1.0" onchange="updateYearSliderValue(this.value);displayPromptAfterGridCell();"/>
						<script>
							$('#yearControl').slider({
								tooltip_position: 'bottom',
								formatter: function(value) {
									return 'Year: ' + value;
								}
							});
							function updateYearSliderValue(value) {
								document.getElementById('yearSliderValue').innerText = value + ' Years';
							}
							</script>
						</div>
						<span id="yearSliderValue" class="year-slider-value">5 Years</span>
						<div class="toggle-switcher-css"> 
							<label class="switch-label">3D</label>
							<div class="form-check form-switch">
								<input class="form-check-input" type="checkbox" id="3d-terrain" />
								<script type="text/javascript">
									$("#3d-terrain").change(function () {
										if (this.checked) {
											water.instance.show3D();
											document.getElementById("myModal_3d").style.display = "block";
										}
										else {
											water.instance.hide3D();
										}
									});
									window.onclick = function(event) {
										if (event.target == document.getElementById("myModal_3d")) {
											document.getElementById("myModal_3d").style.display = "none";
										}
									}
									$(document).ready(function() {
										$('.close_3d').click(function() {
											document.getElementById("myModal_3d").style.display = "none";
										});
										$('.close_3d').click(function() {
											document.getElementById("error-modal").style.display = "none";
											
										});
										
									});
								</script>
							</div>
							<label class="form-check-label" for="flexSwitchCheckDefault">Buildings</label>
							<div class="form-check form-switch">
								<input class="form-check-input" type="checkbox" id="3D-buildings" />
								<script type="text/javascript">
									$("#3D-buildings").change(function () {
										if (this.checked) {
											water.instance.showBuildings();
											document.getElementById("myModal_3d").style.display = "block";
										}
										else {
											water.instance.hideBuildings();
											document.getElementById("myModal_3d").style.display = "none";
										}
									});
								</script>
							</div>
						</div>
						<!-- Lengend -->
						<div>
							<div class="Legend-sec">
								<div class="heading-title">
									<h1>Legend</h1>
								</div>
								<div>
									<div class="water-legends">
										<div class="legend-value" id="legend-water-perm">
											<div class="legend-block" style="background-color: #00008B;"></div>
											<span>Permanent Water Body</span>
										</div>
										<div class="legend-value" id="legend-water-temp">
											<div class="legend-block" style="background-color: #FD0303;"></div>
											<span>Inundated Area</span>
										</div>
										<!-- <div class="legend-value" id="legend-water-temp">
											<div class="legend-block" style="background-color: #f2e947;"></div>
											<span>Water Hotspot</span>
										</div> -->
									</div>
								</div>
							</div>
						</div>
						<div style="display: flex;flex-direction: column;">
							<div>
								<h4 id="layers_h4">Layers</h4>
								<div style="display: flex; flex-direction: row;padding-left: 10px;" id="layer_checkboxes_div">
									
										<div style="width: 50%;">
											<div class='layer-checkbox-item'>
												<input type="checkbox" value="flood" name="Inundated Area" class="select-box layerCheckbox" id="floodLayerCheckbox" onchange="changeLayerDropdownOptions(); updateLayerOnMap();" checked> 
												<span>Inundated Area</span>
											</div>
											<div class='layer-checkbox-item'>
												<input type="checkbox" value="water" name="Permanent Water" class="select-box layerCheckbox" id="waterLayerCheckbox" onchange="changeLayerDropdownOptions(); updateLayerOnMap();" checked>
												<span>Permanent Water</span>
											</div>
											<div class='layer-checkbox-item'>
												<input type="checkbox" value="lclu" name= "LCLU" class="select-box layerCheckbox" id="lcluLayerCheckbox" onchange="changeLayerDropdownOptions(); updateLayerOnMap();toggleLCLULegend();"> 
												<span>LCLU</span>
											</div>
											<div class='layer-checkbox-item'>
												<input type="checkbox" value="populationDensity" name="Population Density" class="select-box layerCheckbox" id="populationDensityLayerCheckbox" onchange="changeLayerDropdownOptions(); updateLayerOnMap();togglePopulationDensityLegend();">
												<span>Population Density</span>
											</div>
										</div>
										
										<div style="width: 50%">
											<div class='layer-checkbox-item'>
												<input type="checkbox" value="soilTexture" name="Soil Texture" class="select-box layerCheckbox" id="soilTextureLayerCheckbox" onchange="changeLayerDropdownOptions(); updateLayerOnMap();toggleSoilTextureLegend();"> 
												<span>Soil Texture</span>
											</div>
											<div class='layer-checkbox-item'>
												<input type="checkbox" value="healthCareAccess" name="Healthcare Access" class="select-box layerCheckbox" id="healthCareAccessLayerCheckbox" onchange="changeLayerDropdownOptions(); updateLayerOnMap();toggleHealthCareAccessLegend();">
												<span><div>Healthcare Access</div></span>
											</div>
										</div>
								</div>

								<script>															
								function changeLayerDropdownOptions() {    
									var layerArray = [];
									const checkboxes = document.querySelectorAll('.layerCheckbox');
									checkboxes.forEach(checkbox => {
										if (checkbox.checked) {
											layerArray.push({ name: checkbox.name, value: checkbox.value });
										} else {
											layerArray = layerArray.filter(item => item.value !== checkbox.value);
										}
									});
									layerArray.sort((a, b) => a.name.localeCompare(b.name)); // Sort by name
									var options = "<option disabled selected hidden>Choose Layer</option>";
									layerArray.forEach((op, i) => {
										options += `<option value="${op.value}" id="${i}">${op.name}</option>`;
									});
									document.getElementById("layerDropdown").innerHTML = options;
								}
								</script>
						<div>
							<div class="transparency">
								<h4>Transparency</h4>
							<div style="padding-left: 10px;">
								<div class="transparency_layer" id="transparency_dropdown_div">
									<select name="layer" id="layerDropdown" title="Choose Layer1"> 
										<option disabled selected hidden>Choose Layer</option>
									</select>
								</div>
								<div>
									<div class="trp-range">
										<label>0%</label>
										<label>100%</label>
									</div>

								<input id="transparencyControl" class="" data-slider-id='transparencyControlSlider' type="text" data-slider-min="0" data-slider-max="1" data-slider-step="0.1" data-slider-value="1.0"/>

								<script>
									$('#transparencyControl').slider({
										tooltip_position: 'bottom',
										formatter: function(value) {
											return 'Opacity: ' + value;
										}
									});
									</script>
								</div>
						</div>

						<div style="padding-left: 10px;" id="reset_transparency_div">
							<h5 style="cursor: pointer;" class="blue" onclick="resetTransparency();">Reset Transparency for all</h5>
						</div>
						<div class="download-btn-div">
							<a type="button" id="download-gee-code" class="submit btn download" disabled >DOWNLOAD GEE CODE</a>
						</div>

						<div style="display:flex; justify-content:space-around">
							<div id="contact-us-div" class="pages">
								<i class="fa fa-comment-o"></i>
								<p>Contact Us</p>
							</div>
							<!-- <div class="pages">
								<i class="fa fa-globe"></i>
								<p>Updates & FAQ</p>
							</div> -->
							<div id="help-div" class="pages">
								<i class="fa fa-external-link"></i>
								<p>Help</p>
							</div>
						</div>
					</div>
					
					<script>
						const resultToggle = document.getElementById("result-toggle");
						const containerResult = document.getElementById("container-result");


						resultToggle.addEventListener("click", function () {
						if (containerResult.style.opacity === "1") {
							containerResult.style.opacity = "0";
							containerResult.style.display = "none";
							document.getElementById("result-toggle").classList.remove('fa-angle-down')
							document.getElementById("result-toggle").classList.add('fa-angle-up')
						} else {
							document.getElementById("result-toggle").classList.remove('fa-angle-up')
							document.getElementById("result-toggle").classList.add('fa-angle-down')
							containerResult.style.opacity = "1";
							containerResult.style.display = "flex";
						}
						});

						const inputBox = document.getElementById('inputBox');
						const suggestionsBox = document.getElementById('suggestionsBox');
						const suggestionsBoxFloodHotspot = document.getElementById('suggestionsBoxFloodHotspot');
						const sendButton = document.querySelector("button");

						// Add an event listener for the Enter key press on the input field
						inputBox.addEventListener("keydown", function(event) {
						if (event.key === "Enter") {
							fetchResponse();
						}
						});
				
						function fillInput(element) {
							inputBox.value = element.textContent;
							suggestionsBox.style.display = 'none';
							suggestionsBoxFloodHotspot.style.display = 'none'
							document.querySelector('.error').style.display = 'none';
						}
				
						inputBox.addEventListener('focus', () => {
							suggestionsBox.style.display = 'block';
							suggestionsBoxFloodHotspot.style.display = 'block'

						});
				
						document.addEventListener('click', (event) => {
							if (!inputBox.contains(event.target)) {
								suggestionsBox.style.display = 'none';
								suggestionsBoxFloodHotspot.style.display = 'none'
							}
						});

						$(document).ready(function() {
							document.getElementById("contact-modal").style.display = "none";
							document.getElementById("help-modal").style.display = "none";
							$(".panel").css("max-height", ($(document).height()-parseInt($(".ui").css('top'), 10))-160);
							document.getElementById("contact-us-div").addEventListener("click", displayContactPopup);
							document.getElementById("help-div").addEventListener("click", displayHelpPopup);
							function displayContactPopup(){
								document.getElementById("contact-modal").style.display = "flex";
							}
							function displayHelpPopup(){
								document.getElementById("help-modal").style.display = "flex";
							}
							$('.close_3d').click(function() {
								document.getElementById("contact-modal").style.display = "none";
								document.getElementById("help-modal").style.display = "none";								
							});			
						});
					</script>
				</div>
				<!-- Warning messages placeholder -->
				<div class="warnings">
					<span></span>
				</div>


				<!-- spinner is shown during calculations -->
				<div>
					<div class="spinner">
						
						<i class="fa fa-circle-o-notch fa-spin"></i> Loading...
					</div>
				</div>

				<div>
					<div class="loading-export">
						<i class="fa fa-circle-o-notch fa-spin"></i> Export in progress...
					</div>
				</div>
				
				
			</div>

	</section>
	<div class="modal" tabindex="-1" id="MsgModal" style="background:#000000ad">
		<div class="modal-dialog">
		  <div class="modal-content">
			<div class="modal-header">
			  <h5 class="modal-title">Welcome to SATGPT</h5>
			  <!-- <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button> -->
			</div>
			<div class="modal-body">
			  <p>The current version of the tool can map inundated areas and hotspots from 1984 to 2021. We are actively developing the next version, which will include data from the missing years and is scheduled for launch in Q4 2024.</p>
			  <button onclick="closeMsgModal()" class="info-modal-btn">OK</button>
			</div>
		  </div>
		</div>
	  </div>
	<div class="modal" tabindex="-1" id="promptModal">
		<div class="modal-dialog">
		  <div class="modal-content">
			<div class="modal-header">
			  <h5 class="modal-title">Select Grid for Flood Data Visualization</h5>
			  <!-- <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button> -->
			</div>
			<div class="modal-body">
			  <p>Please select a grid on the map to view the Flood data from Google Earth Engine (GEE).</p>
			  <button onclick="closeInfoModal()" class="info-modal-btn">OK</button>
			</div>
		  </div>
		</div>
	  </div>
		<div id="myModal_3d" class="modal_3d">
			<!-- Modal content -->
			<div class="modal-content_3d">
				<span class="close_3d">&times;</span>
				<h4>Switch to 3D view</h4>
				<p> Click and drag while holding CTRL to explore the 3D view.
				</p>
			</div>
		</div>

		<!-- Error Modal -->
		<div id="error-modal" class="modal_3d">
			<div class="modal-content_3d">
				<span class="close_3d">&times;</span>
				<h4>No data Available</h4>
				<hr>
				<p> Please change the year or location.
				</p>
			</div>
		</div>

		<div id="contact-modal" class="modal_3d" style="display: none;">
			<div class="modal-content_3d">
				<span class="close_3d">&times;</span>
				<h4>Contact Us</h4>
				<hr>
				<div class="contact-us-details">
					<p>Space Applications Section (SAS)</p> 
					<p>Information and Communications Technology and Disaster Risk Reduction Division (IDD)</p> 
					<p>United Nations Economic and Social Commission for Asia and the Pacific</p>
					<p style="display: flex;align-items: center;"><i class="fa fa-envelope-o" aria-hidden="true" style="font-size: 20px; margin-right: 10px;"></i> <a href="mailto:escap-sas@un.org">escap-sas@un.org</a></p>
					<p style="display: flex;align-items: center;"><i class="fa fa-envelope-o" aria-hidden="true" style="font-size: 20px; margin-right: 10px;"></i><a href="mailto:hamid.mehmood@un.org"> hamid.mehmood@un.org</a></p>
				</div>
				</p>
			</div>
		</div>

		<div id="help-modal" class="modal_3d_help" style="display: none;">
			<div class="modal-content_3d_help">
				<span class="close_3d">&times;</span>
				<hr>
				<div class="help-details">
					{% include 'help.html' %}
				</div>
				</p>
			</div>
		</div>


		<!-- Footer -->
		<section id="pagefooter"></section>


		<!-- Boot application once the body loads. -->
		<script>
			water.boot();
		</script>
	<!-- Spinner -->
	<div id="spinner-overlay" class="overlay">
		<div class="lds-dual-ring"></div>
	</div>
	</body>
</html>
